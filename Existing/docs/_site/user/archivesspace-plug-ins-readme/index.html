<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ArchivesSpace Plug-ins README - ArchivesSpace</title>
    <link rel="stylesheet" href="/archivesspace/assets/stylesheets/main.css">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js" defer></script>
    <script src="/archivesspace/assets/javascripts/site.js" type="text/javascript" charset="utf-8" defer></script>
    <script src="/archivesspace/assets/javascripts/main.js" type="text/javascript" charset="utf-8" defer></script>
    <link rel="alternate" type="application/atom+xml" href="/blog.xml">
  </head>
  <body>
    <div class="wrapper">

      <header class="top">
  <div class="row topbar">
    <h1 id="logo" class="logo">
  <a href="http://archivesspace.org/" title="ArchivesSpace">ArchivesSpace</a>
</h1>

    <nav>
      <ul id="navigation" class="navigation">
        <li><a href="https://archivesspace.atlassian.net/wiki/display/ADC/ArchivesSpace">Wiki</a></li>
        <li><a href="http://docs.archivesspace.org">User Docs</a></li>
        <li class="toggle"><button type="button" id="toggle-menu" class="button--teal">Menu</button></li>
      </ul>
    </nav>
  </div>
</header>


      <div id="content" class="row">

        <div id="sidebar" class="sidebar">
  <div>
    <!-- <h2>Search</h2> -->
    <div class="searchbox">
      <form onsubmit='google_site_search()'>
        <input type="text" id="google-search" class="searchbox-input" placeholder="Search the docs" />
      </form>

      <script language="Javascript" type="text/javascript">
          function google_site_search()
            {
                var query = document.getElementById("google-search").value;
                  window.open("http://google.com/search?q=" + query
                  + "%20site:" + "http://archivesspace.github.io/archivesspace");
                  }
                </script>
    </div>
  </div>
  <!-- <section>
    <h2>Newsletter</h2>
    <div id="mc_embed_signup" style="margin-left: 1.5em; margin-top: 0.5em;">
      <form
         action="http://travis-ci.us7.list-manage.com/subscribe/post?u=8ce724a4c9af4dace663cd39c&amp;id=44f8dff14c"
         method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate"
         target="_blank" novalidate>
        <input type="email" value="" name="EMAIL" class="email" id="mce-EMAIL" placeholder="email address" required/>
        <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
      </form>
    </div>
  </section>
  <section>
    <h2><a href="http://travis-ci.com/?utm_source=docs.travis-ci.org&utm_medium=referral&utm_content=textlink&utm_campaign=docsite_sidebar">Travis CI for Private Repositories</a></h2>
  </section> -->

  <section>
    <h2>Menu</h2>
    <nav>
      <ul>
        <li><a href="/archivesspace/user/system-requirements/">System Requirements</a></li>
        <li><a href="/archivesspace/user/getting-started/">Getting started</a></li>
        <li><a href="/archivesspace/user/configuring-archivesspace/">Configuring ArchivesSpace</a></li>
        <li><a href="/archivesspace/user/upgrading-to-a-new-release-of-archivesspace/">Upgrading ArchivesSpace</a></li>
        <li><a href="/archivesspace/user/running-archivesspace-as-a-unix-daemon/">Running ArchivesSpace as a Unix daemon</a></li>
        <li><a href="/archivesspace/user/running-archivesspace-as-a-windows-service/">Running ArchivesSpace as a Windows Service</a></li>
        <li><a href="/archivesspace/user/running-archivesspace-against-mysql/">Setting up MySQL for Production</a></li>
        <li><a href="/archivesspace/user/backup-and-recovery/">Backup and Recovery</a></li>
        <li><a href="/archivesspace/user/re-creating-indexes/">Re-creating your indexes</a></li>
        <li><a href="/archivesspace/user/resetting-passwords/">Resetting Passwords</a></li>
        <li><a href="/archivesspace/user/tuning-archivesspace/">Tuning ArchivesSpace</a></li>
        <li><a href="/archivesspace/user/configuring-ldap-authentication/">Configuring LDAP authentication</a></li>
        <li><a href="/archivesspace/user/archivesspace-plug-ins-readme/">Plugins and Local Customizations</a></li>
        <li><a href="/archivesspace/user/running-archivesspace-under-a-prefix/">Deploying under a URL prefix</a></li>
        <li><a href="/archivesspace/user/running-archivesspace-with-external-solr/">Using an external Solr index</a></li>
        <li><a href="/archivesspace/user/application-monitoring-with-new-relic/">Monitoring with New Relic</a></li>
      </ul>
      <h2>Developer Guides</h2>
      <ul>
        <li><a href="/archivesspace/user/archivesspace-architecture-overview">Architecture Overview</a></li>
        <li><a href="/archivesspace/api">The API</a></li>
        <li><a href="/archivesspace/user/archivesspace-build-system">Building ArchivesSpace</a></li>
        <li><a href="/archivesspace/user/selenium-test-suite">Running Selenium Tests</a></li>
        <li><a href="/archivesspace/doc">Ruby YARD Documentation</a></li>
        <li><div class="status-circle status">Status:</div>
          <a href="https://travis-ci.org/archivesspace/archivesspace">Travis CI Status</a>
        </li>
      </ul>
    </nav>
  </section>
  <section>
    <h2>Contact</h2>
    <ul>
      <li><a href="https://twitter.com/archivesspace">Twitter</a></li>
      <li><a href="irc://chat.freenode.net/%23archivesspace">IRC</a></li>
      <li><a href="http://github.com/archivesspace">GitHub</a></li>
      <li><a href="mailto:ArchivesSpaceHome@lyrasis.org">Email</a></li>
    </ul>
  </section>
  <section>
    <h2>Contributing</h2>
    <p>This documentation site is open source.
      The <a href="https://github.com/archivesspace/archivesspace/tree/gh-pages">README in our Git repository</a> explains how to contribute.</p>
      <p>This documentation was based on the <a href="https://travis-ci.org">Travis CI</a> documentation. It uses <a href="https://github.com/jekyll/jekyll">Jekyll</a> and <a href="https://github.com/tripit/slate">Slate</a></p>
  </section>
</div><!-- /#sidebar -->


        <main id="main" class="main">
          
            <h1 class="title">ArchivesSpace Plug-ins README</h2>
          
          <hr />

<p>Plug-ins provide a mechanism to customize ArchivesSpace by overriding or extending functions
without changing the core codebase. As they are self-contained, they also permit the ready
sharing of packages of customization between ArchivesSpace instances.</p>

<p>** Enabling plugins</p>

<p>Plug-ins are enabled by placing them in the <code class="highlighter-rouge">plugins</code> directory, and referencing them in the
ArchivesSpace configuration, <code class="highlighter-rouge">common/config/config.rb</code>. For example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AppConfig[:plugins] = ['local', 'hello_world', 'my_plugin']
</code></pre></div></div>

<p>This configuration assumes the following directories exist:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>plugins
  hello_world
  local
  my_plugin
</code></pre></div></div>

<p>Note that the order that the plug-ins are listed in the <code class="highlighter-rouge">:plugins</code> configuration option
determines the order in which they are loaded by the application.</p>

<p>** Plugin structure</p>

<p>The directory structure within a plug-in is similar to the structure of the core application.
The following shows the supported plug-in structure. Files contained in these directories can
be used to override or extend the behavior of the core application.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">backend</span>
  <span class="n">controllers</span> <span class="p">.........</span> <span class="n">backend</span> <span class="n">endpoints</span>
  <span class="k">model</span> <span class="p">...............</span> <span class="n">database</span> <span class="n">mapping</span> <span class="n">models</span>
  <span class="n">converters</span> <span class="p">..........</span> <span class="n">classes</span> <span class="n">for</span> <span class="n">importing</span> <span class="n">data</span>
  <span class="n">job_runners</span> <span class="p">.........</span> <span class="n">classes</span> <span class="n">for</span> <span class="n">defining</span> <span class="n">background</span> <span class="n">jobs</span>
  <span class="n">plugin_init</span><span class="p">.</span><span class="n">rb</span> <span class="p">......</span> <span class="k">if</span> <span class="n">present</span><span class="p">,</span> <span class="n">loaded</span> <span class="n">when</span> <span class="n">the</span> <span class="n">backend</span> <span class="n">first</span> <span class="n">starts</span>
<span class="n">frontend</span>
  <span class="n">assets</span> <span class="p">..............</span> <span class="n">static</span> <span class="n">assets</span> <span class="p">(</span><span class="n">such</span> <span class="k">as</span> <span class="n">images</span><span class="p">,</span> <span class="n">javascript</span><span class="p">)</span> <span class="k">in</span> <span class="n">the</span> <span class="n">staff</span> <span class="n">interface</span>
  <span class="n">controllers</span> <span class="p">.........</span> <span class="n">controllers</span> <span class="n">for</span> <span class="n">the</span> <span class="n">staff</span> <span class="n">interface</span>
  <span class="n">locales</span> <span class="p">.............</span> <span class="n">locale</span> <span class="n">translations</span> <span class="n">for</span> <span class="n">the</span> <span class="n">staff</span> <span class="n">interface</span>
  <span class="n">views</span> <span class="p">...............</span> <span class="n">templates</span> <span class="n">for</span> <span class="n">the</span> <span class="n">staff</span> <span class="n">interface</span>
  <span class="n">plugin_init</span><span class="p">.</span><span class="n">rb</span> <span class="p">......</span> <span class="k">if</span> <span class="n">present</span><span class="p">,</span> <span class="n">loaded</span> <span class="n">when</span> <span class="n">the</span> <span class="n">staff</span> <span class="n">interface</span> <span class="n">first</span> <span class="n">starts</span>
<span class="k">public</span>
  <span class="n">assets</span> <span class="p">..............</span> <span class="n">static</span> <span class="n">assets</span> <span class="p">(</span><span class="n">such</span> <span class="k">as</span> <span class="n">images</span><span class="p">,</span> <span class="n">javascript</span><span class="p">)</span> <span class="k">in</span> <span class="n">the</span> <span class="k">public</span> <span class="n">interface</span>
  <span class="n">controllers</span> <span class="p">.........</span> <span class="n">controllers</span> <span class="n">for</span> <span class="n">the</span> <span class="k">public</span> <span class="n">interface</span>
  <span class="n">locales</span> <span class="p">.............</span> <span class="n">locale</span> <span class="n">translations</span> <span class="n">for</span> <span class="n">the</span> <span class="k">public</span> <span class="n">interface</span>
  <span class="n">views</span> <span class="p">...............</span> <span class="n">templates</span> <span class="n">for</span> <span class="n">the</span> <span class="k">public</span> <span class="n">interface</span>
  <span class="n">plugin_init</span><span class="p">.</span><span class="n">rb</span> <span class="p">......</span> <span class="k">if</span> <span class="n">present</span><span class="p">,</span> <span class="n">loaded</span> <span class="n">when</span> <span class="n">the</span> <span class="k">public</span> <span class="n">interface</span> <span class="n">first</span> <span class="n">starts</span>
<span class="n">migrations</span> <span class="p">............</span> <span class="n">database</span> <span class="n">migrations</span>
<span class="n">schemas</span> <span class="p">...............</span> <span class="n">JSONModel</span> <span class="n">schema</span> <span class="n">definitions</span>
<span class="n">search_definitions</span><span class="p">.</span><span class="n">rb</span> <span class="p">.</span> <span class="n">Advanced</span> <span class="n">search</span> <span class="n">fields</span>
</code></pre></div></div>

<p>** Overriding locales</p>

<p>It is not necessary for a plug-in to have all of these directories. For example, to override
some part of a locale file for the staff interface, you can just add the following structure
to the local plug-in:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>plugins/local/frontend/locales/en.yml
</code></pre></div></div>

<p>This is a general rule. That is, to override behavior, rather then extend it, match the path
to the file that contains the behavior to be overridden.</p>

<p>** Adding your own branding</p>

<p>Another example, to override the branding of the staff interface, add
your own template at:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>plugins/local/frontend/views/site/_branding.html.erb
</code></pre></div></div>

<p>Files such as images, stylesheets and PDFs can be made available as static resources by
placing them in an <code class="highlighter-rouge">assets</code> directory under an enabled plug-in. For example, the following file:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>plugins/local/frontend/assets/my_logo.png
</code></pre></div></div>

<p>Will be available via the following URL:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://your.frontend.domain.and:port/assets/my_logo.png
</code></pre></div></div>

<p>For example, to reference this logo from the custom branding file, use
markup such as:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> &lt;div class="container branding"&gt;
   &lt;img src="&lt;%= #{AppConfig[:frontend_proxy_prefix]} %&gt;assets/my_logo.png" alt="My logo" /&gt;
 &lt;/div&gt;
</code></pre></div></div>

<p>** Plugin configuration</p>

<p>Plug-ins can optionally contain a configuration file at <code class="highlighter-rouge">plugins/[plugin-name]/config.yml</code>.
This configuration file supports the following options:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>system_menu_controller
  The name of a controller that will be accessible via a Plug-ins menu in the System toolbar
repository_menu_controller
  The name of a controller that will be accessible via a Plug-ins menu in the Repository toolbar
parents
  [record-type]
    name
    cardinality
  ...
</code></pre></div></div>

<p><code class="highlighter-rouge">system_menu_controller</code> and <code class="highlighter-rouge">repository_menu_controller</code> specify the names of frontend controllers
that will be accessible via the system and repository toolbars respectively. A <code class="highlighter-rouge">Plug-ins</code> dropdown
will appear in the toolbars if any enabled plug-ins have declared these configuration options. The
controller name follows the standard naming conventions, for example:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>repository_menu_controller: hello_world
</code></pre></div></div>

<p>Points to a controller file at <code class="highlighter-rouge">plugins/hello_world/frontend/controllers/hello_world_controller.rb</code>
which implements a controller class called <code class="highlighter-rouge">HelloWorldController</code>. When the menu item is selected
by the user, the <code class="highlighter-rouge">index</code> action is called on the controller.</p>

<p>Note that the URLs for plug-in controllers are scoped under <code class="highlighter-rouge">plugins</code>, so the URL for the above
example is:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://your.frontend.domain.and:port/plugins/hello_world
</code></pre></div></div>

<p>Also note that the translation for the plug-in’s name in the <code class="highlighter-rouge">Plug-ins</code> dropdown menu is specified
in a locale file in the <code class="highlighter-rouge">frontend/locales</code> directory in the plug-in. For example, in the <code class="highlighter-rouge">hello_world</code>
example there is an English locale file at:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>plugins/hello_world/frontend/locales/en.yml
</code></pre></div></div>

<p>The translation for the plug-in name in the <code class="highlighter-rouge">Plug-ins</code> dropdown menus is specified by the key <code class="highlighter-rouge">label</code>
under the plug-in, like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>en:
  plugins:
    hello_world:
      label: Hello World
</code></pre></div></div>

<p>Note that the example locale file contains other keys that specify translations for text displayed
as part of the plug-in’s user interface. Be sure to place your plug-in’s translations as shown, under
<code class="highlighter-rouge">plugins.[your_plugin_name]</code> in order to avoid accidentally overriding translations for other
interface elements. In the example above, the translation for the <code class="highlighter-rouge">label</code> key can be referenced
directly in an erb view file as follows:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;%= I18n.t("plugins.hello_world.label") %&gt;
</code></pre></div></div>

<p>Each entry under <code class="highlighter-rouge">parents</code> specifies a record type that this plug-in provides a new subrecord for.
<code class="highlighter-rouge">[record-type]</code> is the name of the existing record type, for example <code class="highlighter-rouge">accession</code>. <code class="highlighter-rouge">name</code> is the
name of the plug-in in its role as a subrecord of this parent, for example <code class="highlighter-rouge">hello_worlds</code>.
<code class="highlighter-rouge">cardinality</code> specifies the cardinality of the plug-in records. Currently supported values are
<code class="highlighter-rouge">zero-to-many</code> and <code class="highlighter-rouge">zero-to-one</code>.</p>

<p>** Changing search behavior</p>

<p>A plugin can add additional fields to the advanced search interface by
including a <code class="highlighter-rouge">search_definitions.rb</code> file at the top-level of the
plugin directory.  This file can contain definitions such as the
following:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AdvancedSearch.define_field(:name =&gt; 'payment_fund_code', :type =&gt; :enum, :visibility =&gt; [:staff], :solr_field =&gt; 'payment_fund_code_u_utext')
AdvancedSearch.define_field(:name =&gt; 'payment_authorizers', :type =&gt; :text, :visibility =&gt; [:staff], :solr_field =&gt; 'payment_authorizers_u_utext')
</code></pre></div></div>

<p>Each field defined will appear in the advanced search interface as a
searchable field.  The <code class="highlighter-rouge">:visibility</code> option controls whether the field
is presented in the staff or public interface (or both), while the
<code class="highlighter-rouge">:type</code> parameter determines what sort of search is being performed.
Valid values are <code class="highlighter-rouge">:text:</code>, <code class="highlighter-rouge">:boolean</code>, <code class="highlighter-rouge">:date</code> and <code class="highlighter-rouge">:enum</code>.  Finally,
the <code class="highlighter-rouge">:solr_field</code> parameter controls which field is used from the
underlying index.</p>

<p>** Further information</p>

<p>Please refer to the <code class="highlighter-rouge">hello_world</code> exemplar plug-in to find out more about how to implement
a plug-in. Be sure to test your plug-in thoroughly as it may have unanticipated impacts on your
ArchivesSpace application. Plug-ins are a powerful feature, designed to allow you to change
most aspects of how the application behaves.</p>

        </main>
      </div><!-- /#content -->

      <footer>
  <div class="row">
  </div>
</footer>

    </div><!-- /.wrapper -->
  </body>
</html>
